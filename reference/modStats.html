<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate common model evaluation statistics ‚Äî modStats ‚Ä¢ openair</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate common model evaluation statistics ‚Äî modStats"><meta name="description" content="Function to calculate common numerical model evaluation statistics with
flexible conditioning."><meta property="og:description" content="Function to calculate common numerical model evaluation statistics with
flexible conditioning."><meta property="og:image" content="https://openair-project.github.io/openair/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">openair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.19.2.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/openair.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project" aria-label="Website"><span class="fa fa-globe"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://openair-project.github.io/book/" aria-label="Book"><span class="fa fa-book"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project/openair/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages"><li><h6 class="dropdown-header" data-toc-skip>Data Analysis</h6></li>
    <li><a class="dropdown-item" href="https://openair-project.github.io/openair/">üß≠ openair</a></li>
    <li><a class="dropdown-item" href="https://openair-project.github.io/openairmaps/">üó∫Ô∏è openairmaps</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/deweather/">üìâ deweather</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data Access</h6></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/worldmet/">üçÉ worldmet</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/euroaq/">üåç euroaq</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/ukaq/">üëë ukaq</a></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate common model evaluation statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/openair-project/openair/blob/main/R/modStats.R" class="external-link"><code>R/modStats.R</code></a></small>
      <div class="d-none name"><code>modStats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to calculate common numerical model evaluation statistics with
flexible conditioning.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modStats</span><span class="op">(</span></span>
<span>  <span class="va">mydata</span>,</span>
<span>  mod <span class="op">=</span> <span class="st">"mod"</span>,</span>
<span>  obs <span class="op">=</span> <span class="st">"obs"</span>,</span>
<span>  statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"FAC2"</span>, <span class="st">"MB"</span>, <span class="st">"MGE"</span>, <span class="st">"NMB"</span>, <span class="st">"NMGE"</span>, <span class="st">"RMSE"</span>, <span class="st">"r"</span>, <span class="st">"COE"</span>, <span class="st">"IOA"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  rank.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mydata">mydata<a class="anchor" aria-label="anchor" href="#arg-mydata"></a></dt>
<dd><p>A data frame.</p></dd>


<dt id="arg-mod">mod<a class="anchor" aria-label="anchor" href="#arg-mod"></a></dt>
<dd><p>Name of a variable in <code>mydata</code> that represents modelled
values.</p></dd>


<dt id="arg-obs">obs<a class="anchor" aria-label="anchor" href="#arg-obs"></a></dt>
<dd><p>Name of a variable in <code>mydata</code> that represents measured
values.</p></dd>


<dt id="arg-statistic">statistic<a class="anchor" aria-label="anchor" href="#arg-statistic"></a></dt>
<dd><p>The statistic to be calculated. See details below for a
description of each.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>type</code> determines how the data are split i.e. conditioned,
and then plotted. The default is will produce statistics using the entire
data. <code>type</code> can be one of the built-in types as detailed in
<code>cutData</code> e.g. ‚Äúseason‚Äù, ‚Äúyear‚Äù, ‚Äúweekday‚Äù and so
on. For example, <code>type = "season"</code> will produce four sets of
statistics ‚Äî one for each season.</p>
<p>It is also possible to choose <code>type</code> as another variable in the data
frame. If that variable is numeric, then the data will be split into four
quantiles (if possible) and labelled accordingly. If type is an existing
character or factor variable, then those categories/levels will be used
directly. This offers great flexibility for understanding the variation of
different variables and how they depend on one another.</p>
<p>More than one type can be considered e.g. <code>type = c("season", "weekday")</code> will produce statistics split by season and day of the week.</p></dd>


<dt id="arg-rank-name">rank.name<a class="anchor" aria-label="anchor" href="#arg-rank-name"></a></dt>
<dd><p>Simple model ranking can be carried out if <code>rank.name</code>
is supplied. <code>rank.name</code> will generally refer to a column representing
a model name, which is to ranked. The ranking is based the COE performance,
as that indicator is arguably the best single model performance indicator
available.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="cutData.html">cutData</a></code></p><dl><dt><code>x</code></dt>
<dd><p>A data frame containing a field <code>date</code>.</p></dd>

    <dt><code>names</code></dt>
<dd><p>By default, the columns created by <code><a href="cutData.html">cutData()</a></code> are named after
their <code>type</code> option. Specifying <code>names</code> defines other names for the
columns, which map onto the <code>type</code> options in the same order they are
given. The length of <code>names</code> should therefore be equal to the length of
<code>type</code>.</p></dd>

    <dt><code>suffix</code></dt>
<dd><p>If <code>name</code> is not specified, <code>suffix</code> will be appended to any
added columns that would otherwise overwrite existing columns. For example,
<code>cutData(mydata, "nox", suffix = "_cuts")</code> would append a <code>nox_cuts</code> column
rather than overwriting <code>nox</code>.</p></dd>

    <dt><code>hemisphere</code></dt>
<dd><p>Can be <code>"northern"</code> or <code>"southern"</code>, used to split data
into seasons.</p></dd>

    <dt><code>n.levels</code></dt>
<dd><p>Number of quantiles to split numeric data into.</p></dd>

    <dt><code>start.day</code></dt>
<dd><p>What day of the week should the <code>type = "weekday"</code> start on?
The user can change the start day by supplying an integer between 0 and 6.
Sunday = 0, Monday = 1, ... For example to start the weekday plots on a
Saturday, choose <code>start.day = 6</code>.</p></dd>

    <dt><code>is.axis</code></dt>
<dd><p>A logical (<code>TRUE</code>/<code>FALSE</code>), used to request shortened cut
labels for axes.</p></dd>

    <dt><code>local.tz</code></dt>
<dd><p>Used for identifying whether a date has daylight savings time
(DST) applied or not. Examples include <code>local.tz = "Europe/London"</code>,
<code>local.tz = "America/New_York"</code>, i.e., time zones that assume DST.
<a href="https://en.wikipedia.org/wiki/List_of_zoneinfo_time_zones" class="external-link">https://en.wikipedia.org/wiki/List_of_zoneinfo_time_zones</a> shows time
zones that should be valid for most systems. It is important that the
original data are in GMT (UTC) or a fixed offset from GMT.</p></dd>

    <dt><code>latitude,longitude</code></dt>
<dd><p>The decimal latitude and longitudes used when <code>type = "daylight"</code>. Note that locations west of Greenwich have negative
longitudes.</p></dd>

    <dt><code>drop</code></dt>
<dd><p>How to handle empty factor levels. One of:</p><ul><li><p><code>"default"</code>: Sensible defaults selected on a case-by-case basis for
different <code>type</code> options.</p></li>
<li><p><code>"empty"</code>: Drop all empty factor levels.</p></li>
<li><p><code>"none"</code>: Retain all empty factor levels, where possible. For example,
for <code>type = "hour"</code>, all factor levels from <code>0</code> and <code>23</code> will be
represented.</p></li>
<li><p><code>"outside"</code>: Retain empty factor levels within the range of the data.
For example, for <code>type = "hour"</code> when the data only contains data for 1 AM
and 5 AM, the factor levels, <code>1</code>, <code>2</code>, <code>3</code>, <code>4</code> and <code>5</code> will be retained.</p></li>
</ul><p>Some of these options only apply to certain <code>type</code> options. For example,
for <code>type = "year"</code>, <code>"outside"</code> is equivalent to <code>"none"</code> as there is no
fixed range of years to use in the <code>"none"</code> case.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a data frame with model evaluation statistics.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is under development and currently provides some common model
evaluation statistics. These include (to be mathematically defined later):</p>
<ul><li><p>\(n\), the number of complete pairs of data.</p></li>
<li><p>\(FAC2\), fraction of predictions within a factor of two.</p></li>
<li><p>\(MB\), the mean bias.</p></li>
<li><p>\(MGE\), the mean gross error.</p></li>
<li><p>\(NMB\), the normalised mean bias.</p></li>
<li><p>\(NMGE\), the normalised mean gross error.</p></li>
<li><p>\(RMSE\), the root mean squared error.</p></li>
<li><p>\(r\), the Pearson correlation coefficient. Note, can also supply and
argument <code>method</code> e.g. <code>method = "spearman"</code>. Also returned is the
P value of the correlation coefficient, \(P\), which may present as <code>0</code> for
very low values.</p></li>
<li><p>\(COE\), the <em>Coefficient of Efficiency</em> based on Legates and
McCabe (1999, 2012). There have been many suggestions for measuring model
performance over the years, but the COE is a simple formulation which is easy
to interpret.</p>
<p>A perfect model has a COE = 1. As noted by Legates and McCabe although the
COE has no lower bound, a value of COE = 0.0 has a fundamental meaning. It
implies that the model is no more able to predict the observed values than
does the observed mean. Therefore, since the model can explain no more of the
variation in the observed values than can the observed mean, such a model can
have no predictive advantage.</p>
<p>For negative values of COE, the model is less effective than the observed
mean in predicting the variation in the observations.</p></li>
<li><p>\(IOA\), the
Index of Agreement based on Willmott et al. (2011), which spans between -1
and +1 with values approaching +1 representing better model performance.</p>
<p>An IOA of 0.5, for example, indicates that the sum of the error-magnitudes is
one half of the sum of the observed-deviation magnitudes.  When IOA = 0.0, it
signifies that the sum of the magnitudes of the errors and the sum of the
observed-deviation magnitudes are equivalent. When IOA = -0.5, it indicates
that the sum of the error-magnitudes is twice the sum of the perfect
model-deviation and observed-deviation magnitudes. Values of IOA near -1.0
can mean that the model-estimated deviations about O are poor estimates of
the observed deviations; but, they also can mean that there simply is little
observed variability - so some caution is needed when the IOA approaches -1.</p></li>
</ul><p>All statistics are based on complete pairs of <code>mod</code> and <code>obs</code>.</p>
<p>Conditioning is possible through setting <code>type</code>, which can be a vector
e.g. <code>type = c("weekday", "season")</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Legates DR, McCabe GJ. (1999). Evaluating the use of
goodness-of-fit measures in hydrologic and hydroclimatic model validation.
Water Resources Research 35(1): 233-241.</p>
<p>Legates DR, McCabe GJ. (2012). A refined index of model performance: a
rejoinder, International Journal of Climatology.</p>
<p>Willmott, C.J., Robeson, S.M., Matsuura, K., 2011. A refined index of model
performance. International Journal of Climatology.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other model evaluation functions:
<code><a href="TaylorDiagram.html">TaylorDiagram()</a></code>,
<code><a href="conditionalEval.html">conditionalEval()</a></code>,
<code><a href="conditionalQuantile.html">conditionalQuantile()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Carslaw</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## the example below is somewhat artificial --- assuming the observed</span></span></span>
<span class="r-in"><span><span class="co">## values are given by NOx and the predicted values by NO2.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">modStats</span><span class="op">(</span><span class="va">mydata</span>, mod <span class="op">=</span> <span class="st">"no2"</span>, obs <span class="op">=</span> <span class="st">"nox"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 √ó 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   default      n  FAC2    MB   MGE    NMB  NMGE  RMSE     r     P    COE   IOA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> all data <span style="text-decoration: underline;">63</span>095 0.170 -<span style="color: #BB0000;">130.</span>  130. -<span style="color: #BB0000;">0.725</span> 0.726  167. 0.787     0 -<span style="color: #BB0000;">0.337</span> 0.331</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## evaluation stats by season</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">modStats</span><span class="op">(</span><span class="va">mydata</span>, mod <span class="op">=</span> <span class="st">"no2"</span>, obs <span class="op">=</span> <span class="st">"nox"</span>, type <span class="op">=</span> <span class="st">"season"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 √ó 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   season        n   FAC2    MB   MGE    NMB  NMGE  RMSE     r     P    COE   IOA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> spring (‚Ä¶ <span style="text-decoration: underline;">17</span>343 0.258  -<span style="color: #BB0000;">108.</span>  108. -<span style="color: #BB0000;">0.685</span> 0.685  140. 0.820     0 -<span style="color: #BB0000;">0.250</span> 0.375</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> summer (‚Ä¶ <span style="text-decoration: underline;">14</span>658 0.171  -<span style="color: #BB0000;">116.</span>  116. -<span style="color: #BB0000;">0.705</span> 0.705  145. 0.757     0 -<span style="color: #BB0000;">0.420</span> 0.290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> autumn (‚Ä¶ <span style="text-decoration: underline;">14</span>775 0.098<span style="text-decoration: underline;">3</span> -<span style="color: #BB0000;">154.</span>  154. -<span style="color: #BB0000;">0.753</span> 0.753  192. 0.788     0 -<span style="color: #BB0000;">0.437</span> 0.281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> winter (‚Ä¶ <span style="text-decoration: underline;">16</span>319 0.142  -<span style="color: #BB0000;">143.</span>  143. -<span style="color: #BB0000;">0.749</span> 0.751  185. 0.826     0 -<span style="color: #BB0000;">0.321</span> 0.340</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Carslaw, Jack Davison, Karl Ropkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

