<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Whittaker-Eilers Smoothing and Interpolation ‚Äî WhittakerSmooth ‚Ä¢ openair</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Whittaker-Eilers Smoothing and Interpolation ‚Äî WhittakerSmooth"><meta name="description" content="This function applies the Whittaker-Eilers smoothing and interpolation method
to a specified pollutant in a data frame. The method is based on penalised
least squares and is designed to handle time series data with missing values,
providing a smoothed estimate of the pollutant concentrations over time. The
function allows for flexible control over the amount of smoothing through the
lambda parameter and can be applied to multiple pollutants simultaneously."><meta property="og:description" content="This function applies the Whittaker-Eilers smoothing and interpolation method
to a specified pollutant in a data frame. The method is based on penalised
least squares and is designed to handle time series data with missing values,
providing a smoothed estimate of the pollutant concentrations over time. The
function allows for flexible control over the amount of smoothing through the
lambda parameter and can be applied to multiple pollutants simultaneously."><meta property="og:image" content="https://openair-project.github.io/openair/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">openair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.19.2.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/openair.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project" aria-label="Website"><span class="fa fa-globe"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://openair-project.github.io/book/" aria-label="Book"><span class="fa fa-book"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project/openair/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages"><li><h6 class="dropdown-header" data-toc-skip>Data Analysis</h6></li>
    <li><a class="dropdown-item" href="https://openair-project.github.io/openair/">üß≠ openair</a></li>
    <li><a class="dropdown-item" href="https://openair-project.github.io/openairmaps/">üó∫Ô∏è openairmaps</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/deweather/">üìâ deweather</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data Access</h6></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/worldmet/">üçÉ worldmet</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/euroaq/">üåç euroaq</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/ukaq/">üëë ukaq</a></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Whittaker-Eilers Smoothing and Interpolation</h1>
      <small class="dont-index">Source: <a href="https://github.com/openair-project/openair/blob/main/R/Whittaker_smooth.R" class="external-link"><code>R/Whittaker_smooth.R</code></a></small>
      <div class="d-none name"><code>WhittakerSmooth.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies the Whittaker-Eilers smoothing and interpolation method
to a specified pollutant in a data frame. The method is based on penalised
least squares and is designed to handle time series data with missing values,
providing a smoothed estimate of the pollutant concentrations over time. The
function allows for flexible control over the amount of smoothing through the
<code>lambda</code> parameter and can be applied to multiple pollutants simultaneously.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">WhittakerSmooth</span><span class="op">(</span></span>
<span>  <span class="va">mydata</span>,</span>
<span>  pollutant <span class="op">=</span> <span class="st">"o3"</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">24L</span>,</span>
<span>  d <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  new.name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date.pad <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mydata">mydata<a class="anchor" aria-label="anchor" href="#arg-mydata"></a></dt>
<dd><p>A data frame containing a <code>date</code> field. <code>mydata</code> must contain a
<code>date</code> field in <code>Date</code> or <code>POSIXct</code> format.</p></dd>


<dt id="arg-pollutant">pollutant<a class="anchor" aria-label="anchor" href="#arg-pollutant"></a></dt>
<dd><p>The name of a pollutant, e.g., <code>pollutant = "o3"</code>. More than
one pollutant can be supplied as a vector, e.g., <code>pollutant = c("o3", "nox")</code>.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>The value of <code>lambda</code> to use in the smoothing. This controls
the amount of smoothing, with higher values leading to smoother results. If
<code>lambda = NA</code> Generalised Cross Validation (GCV) is used to select the
optimal value of <code>lambda</code> for each pollutant. This can be time consuming,
so a fixed value of <code>lambda</code> is recommended for large datasets or multiple
pollutants. Note that the value of <code>lambda</code> needs to increase exponetially
to smooth long time series data of several years e.g. <code>lambda = 10e9</code>.</p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>The order used to penalise the roughness of the data. By default
this is set to 2, which penalises the second derivative of the data.
Setting <code>d = 1</code> will penalise the first derivative, which can be useful for
smoothing data with sharp peaks or troughs. Setting <code>d = 1</code> will
effectively linearly interpolate across missing data.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Used for splitting the data further. Passed to <code><a href="cutData.html">cutData()</a></code>.</p></dd>


<dt id="arg-new-name">new.name<a class="anchor" aria-label="anchor" href="#arg-new-name"></a></dt>
<dd><p>The name given to the new column(s). If not supplied it will
create a name based on the name of the pollutant.</p></dd>


<dt id="arg-date-pad">date.pad<a class="anchor" aria-label="anchor" href="#arg-date-pad"></a></dt>
<dd><p>Should missing dates be padded? Default is <code>FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional parameters passed to <code><a href="cutData.html">cutData()</a></code>. For use with <code>type</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with new columns for the smoothed pollutant values.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function is designed to work with regularly spaced time series.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Paul H. C. Eilers, A Perfect Smoother, Analytical Chemistry 2003
75 (14), 3631-3636, DOI: 10.1021/ac034173t</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Carslaw</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Smoothing with lambda = 24</span></span></span>
<span class="r-in"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu">WhittakerSmooth</span><span class="op">(</span><span class="va">mydata</span>, pollutant <span class="op">=</span> <span class="st">"o3"</span>, lambda <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Carslaw, Jack Davison, Karl Ropkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

