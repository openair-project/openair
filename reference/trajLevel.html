<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trajectory level plots with conditioning ‚Äî trajLevel ‚Ä¢ openair</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trajectory level plots with conditioning ‚Äî trajLevel"><meta name="description" content="This function plots gridded back trajectories. This function requires that
data are imported using the importTraj() function."><meta property="og:description" content="This function plots gridded back trajectories. This function requires that
data are imported using the importTraj() function."><meta property="og:image" content="https://openair-project.github.io/openair/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">openair</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.19.2.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/openair.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project" aria-label="Website"><span class="fa fa-globe"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://openair-project.github.io/book/" aria-label="Book"><span class="fa fa-book"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project/openair/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages"><li><h6 class="dropdown-header" data-toc-skip>Data Analysis</h6></li>
    <li><a class="dropdown-item" href="https://openair-project.github.io/openair/">üß≠ openair</a></li>
    <li><a class="dropdown-item" href="https://openair-project.github.io/openairmaps/">üó∫Ô∏è openairmaps</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/deweather/">üìâ deweather</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data Access</h6></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/worldmet/">üçÉ worldmet</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/euroaq/">üåç euroaq</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/ukaq/">üëë ukaq</a></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Trajectory level plots with conditioning</h1>
      <small class="dont-index">Source: <a href="https://github.com/openair-project/openair/blob/main/R/trajLevel.R" class="external-link"><code>R/trajLevel.R</code></a></small>
      <div class="d-none name"><code>trajLevel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots gridded back trajectories. This function requires that
data are imported using the <code><a href="importTraj.html">importTraj()</a></code> function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trajLevel</span><span class="op">(</span></span>
<span>  <span class="va">mydata</span>,</span>
<span>  lon <span class="op">=</span> <span class="st">"lon"</span>,</span>
<span>  lat <span class="op">=</span> <span class="st">"lat"</span>,</span>
<span>  pollutant <span class="op">=</span> <span class="st">"height"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"frequency"</span>,</span>
<span>  percentile <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  lon.inc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lat.inc <span class="op">=</span> <span class="va">lon.inc</span>,</span>
<span>  min.bin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  .combine <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  crs <span class="op">=</span> <span class="fl">4326</span>,</span>
<span>  map <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  map.fill <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  map.cols <span class="op">=</span> <span class="st">"grey40"</span>,</span>
<span>  map.border <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  map.alpha <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  map.lwd <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  map.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  grid.col <span class="op">=</span> <span class="st">"deepskyblue"</span>,</span>
<span>  grid.nx <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  grid.ny <span class="op">=</span> <span class="va">grid.nx</span>,</span>
<span>  origin <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  key <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  key.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  key.columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  auto.text <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mydata">mydata<a class="anchor" aria-label="anchor" href="#arg-mydata"></a></dt>
<dd><p>Data frame, the result of importing a trajectory file using
<code><a href="importTraj.html">importTraj()</a></code>.</p></dd>


<dt id="arg-lon-lat">lon, lat<a class="anchor" aria-label="anchor" href="#arg-lon-lat"></a></dt>
<dd><p>Columns containing the decimal longitude and latitude.</p></dd>


<dt id="arg-pollutant">pollutant<a class="anchor" aria-label="anchor" href="#arg-pollutant"></a></dt>
<dd><p>Pollutant (or any numeric column) to be plotted, if any.
Alternatively, use <code>group</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p><code>type</code> determines how the data are split, i.e., conditioned, and
then plotted. The default is will produce a single plot using the entire
data. Type can be one of the built-in types as detailed in <code>cutData</code> e.g.
"season", "year", "weekday" and so on. For example, <code>type = "season"</code> will
produce four plots ‚Äî one for each season.</p>
<p>It is also possible to choose <code>type</code> as another variable in the data frame.
If that variable is numeric, then the data will be split into four
quantiles (if possible) and labelled accordingly. If type is an existing
character or factor variable, then those categories/levels will be used
directly. This offers great flexibility for understanding the variation of
different variables and how they depend on one another.</p>
<p><code>type</code> can be up length two e.g. <code>type = c("season", "weekday")</code> will
produce a 2x2 plot split by season and day of the week. Note, when two
types are provided the first forms the columns and the second the rows.</p></dd>


<dt id="arg-smooth">smooth<a class="anchor" aria-label="anchor" href="#arg-smooth"></a></dt>
<dd><p>Should the trajectory surface be smoothed?</p></dd>


<dt id="arg-statistic">statistic<a class="anchor" aria-label="anchor" href="#arg-statistic"></a></dt>
<dd><p>One of:</p><ul><li><p><code>"frequency"</code> (the default) shows trajectory frequencies.</p></li>
<li><p><code>"hexbin"</code>, which is similar to <code>"frequency"</code> but shows a hexagonal
grid of counts.</p></li>
<li><p><code>"difference"</code> - in this case trajectories where the associated
concentration is greater than <code>percentile</code> are compared with the the full
set of trajectories to understand the differences in frequencies of the
origin of air masses. The comparison is made by comparing the percentage
change in gridded frequencies. For example, such a plot could show that the
top 10\<!-- % of concentrations of PM10 tend to originate from air-mass origins -->
to the east.</p></li>
<li><p><code>"pscf"</code> for a Potential Source Contribution Function map. This statistic
method interacts with <code>percentile</code>.</p></li>
<li><p><code>"cwt"</code> for concentration weighted trajectories.</p></li>
<li><p><code>"sqtba"</code> to undertake Simplified Quantitative Transport Bias
Analysis. This statistic method interacts with <code>.combine</code> and <code>sigma</code>.</p></li>
</ul></dd>


<dt id="arg-percentile">percentile<a class="anchor" aria-label="anchor" href="#arg-percentile"></a></dt>
<dd><p>The percentile concentration of <code>pollutant</code> against which
the all trajectories are compared.</p></dd>


<dt id="arg-lon-inc-lat-inc">lon.inc, lat.inc<a class="anchor" aria-label="anchor" href="#arg-lon-inc-lat-inc"></a></dt>
<dd><p>The longitude and latitude intervals to be used for
binning data. If <code>statistic = "hexbin"</code>, the minimum value out of of
<code>lon.inc</code> and <code>lat.inc</code> is passed to the <code>binwidth</code> argument of
<code><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html" class="external-link">ggplot2::geom_hex()</a></code>.</p></dd>


<dt id="arg-min-bin">min.bin<a class="anchor" aria-label="anchor" href="#arg-min-bin"></a></dt>
<dd><p>The minimum number of unique points in a grid cell. Counts
below <code>min.bin</code> are set as missing.</p></dd>


<dt id="arg--combine">.combine<a class="anchor" aria-label="anchor" href="#arg--combine"></a></dt>
<dd><p>When statistic is "SQTBA" it is possible to combine lots of
receptor locations to derive a single map. <code>.combine</code> identifies the column
that differentiates different sites (commonly a column named <code>"site"</code>).
Note that individual site maps are normalised first by dividing by their
mean value.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>For the SQTBA approach <code>sigma</code> determines the amount of back
trajectory spread based on the Gaussian plume equation. Values in the
literature suggest 5.4 km after one hour. However, testing suggests lower
values reveal source regions more effectively while not introducing too
much noise.</p></dd>


<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>Colours for plotting. Passed to <code><a href="openColours.html">openColours()</a></code>.</p></dd>


<dt id="arg-crs">crs<a class="anchor" aria-label="anchor" href="#arg-crs"></a></dt>
<dd><p>The coordinate reference system to use for plotting. Defaults to
<code>4326</code>, which is the WGS84 geographic coordinate system, the standard,
unprojected latitude/longitude system used in GPS, Google Earth, and GIS
mapping. Other <code>crs</code> values are available - for example, <code>27700</code> will use
the the OSGB36/British National Grid.</p></dd>


<dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>Should a base map be drawn? If <code>TRUE</code> the world base map provided
by <code><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">ggplot2::map_data()</a></code> will be used.</p></dd>


<dt id="arg-map-fill">map.fill<a class="anchor" aria-label="anchor" href="#arg-map-fill"></a></dt>
<dd><p>Should the base map be a filled polygon? Default is to fill
countries.</p></dd>


<dt id="arg-map-cols">map.cols<a class="anchor" aria-label="anchor" href="#arg-map-cols"></a></dt>
<dd><p>If <code>map.fill = TRUE</code> <code>map.cols</code> controls the fill colour.
Examples include <code>map.fill = "grey40"</code> and <code>map.fill = openColours("default", 10)</code>. The latter colours the countries and can help
differentiate them.</p></dd>


<dt id="arg-map-border">map.border<a class="anchor" aria-label="anchor" href="#arg-map-border"></a></dt>
<dd><p>The colour to use for the map outlines/borders. Defaults to
<code>"black"</code>.</p></dd>


<dt id="arg-map-alpha">map.alpha<a class="anchor" aria-label="anchor" href="#arg-map-alpha"></a></dt>
<dd><p>The transparency level of the filled map which takes values
from 0 (full transparency) to 1 (full opacity). Setting it below 1 can help
view trajectories, trajectory surfaces etc. <em>and</em> a filled base map.</p></dd>


<dt id="arg-map-lwd">map.lwd<a class="anchor" aria-label="anchor" href="#arg-map-lwd"></a></dt>
<dd><p>The map line width, a positive number, defaulting to <code>1</code>.</p></dd>


<dt id="arg-map-lty">map.lty<a class="anchor" aria-label="anchor" href="#arg-map-lty"></a></dt>
<dd><p>The map line type. Line types can either be specified as an
integer (<code>0</code> = blank, <code>1</code> = solid (default), <code>2</code> = dashed, <code>3</code> = dotted,
<code>4</code> = dotdash, <code>5</code> = longdash, <code>6</code> = twodash) or as one of the character
strings "blank", "solid", "dashed", "dotted", "dotdash", "longdash", or
"twodash", where "blank" uses 'invisible lines' (i.e., does not draw them).</p></dd>


<dt id="arg-grid-col">grid.col<a class="anchor" aria-label="anchor" href="#arg-grid-col"></a></dt>
<dd><p>The colour of the map grid to be used. To remove the grid set
<code>grid.col = "transparent"</code>.</p></dd>


<dt id="arg-grid-nx-grid-ny">grid.nx, grid.ny<a class="anchor" aria-label="anchor" href="#arg-grid-nx-grid-ny"></a></dt>
<dd><p>The approximate number of ticks to draw on the map
grid. <code>grid.nx</code> defaults to <code>9</code>, and <code>grid.ny</code> defaults to whatever value
is passed to <code>grid.nx</code>. Setting both values to <code>0</code> will remove the grid
entirely. The number of ticks is approximate as this value is passed to
<code><a href="https://scales.r-lib.org/reference/breaks_pretty.html" class="external-link">scales::breaks_pretty()</a></code> to determine nice-looking, round breakpoints.</p></dd>


<dt id="arg-origin">origin<a class="anchor" aria-label="anchor" href="#arg-origin"></a></dt>
<dd><p>If true a filled circle dot is shown to mark the receptor
point.</p></dd>


<dt id="arg-key">key<a class="anchor" aria-label="anchor" href="#arg-key"></a></dt>
<dd><p>Should a key be drawn? Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-key-position">key.position<a class="anchor" aria-label="anchor" href="#arg-key-position"></a></dt>
<dd><p>Location where the scale key should be plotted. Allowed
arguments currently include <code>"top"</code>, <code>"right"</code>, <code>"bottom"</code>, and <code>"left"</code>.</p></dd>


<dt id="arg-key-columns">key.columns<a class="anchor" aria-label="anchor" href="#arg-key-columns"></a></dt>
<dd><p>Number of columns to be used in the key.</p></dd>


<dt id="arg-auto-text">auto.text<a class="anchor" aria-label="anchor" href="#arg-auto-text"></a></dt>
<dd><p>Either <code>TRUE</code> (default) or <code>FALSE</code>. If <code>TRUE</code>
titles and axis labels will automatically try and format pollutant names
and units properly e.g.  by subscripting the ‚Äò2‚Äô in NO2.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Should a plot be produced? <code>FALSE</code> can be useful when analysing
data to extract plot components and plotting them in other ways.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Addition options are passed on to <code><a href="cutData.html">cutData()</a></code> for <code>type</code> handling.
Some additional arguments are also available:</p><ul><li><p><code>xlab</code>, <code>ylab</code> and <code>main</code> override the x-axis label, y-axis label, and plot title.</p></li>
<li><p><code>layout</code> sets the layout of facets - e.g., <code>layout(2, 5)</code> will have 2 columns and 5 rows.</p></li>
<li><p><code>fontsize</code> overrides the overall font size of the plot.</p></li>
<li><p><code>border</code> sets the border colour of each tile.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an <a href="openair-package.html">openair</a> object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An alternative way of showing the trajectories compared with plotting
trajectory lines is to bin the points into latitude/longitude intervals. For
these purposes <code>trajLevel()</code> should be used. There are several trajectory
statistics that can be plotted as gridded surfaces. First, <code>statistic</code> can be
set to "frequency" to show the number of back trajectory points in a grid
square. Grid squares are by default at 1 degree intervals, controlled by
<code>lat.inc</code> and <code>lon.inc</code>. Such plots are useful for showing the frequency of
air mass locations. Note that it is also possible to set <code>statistic = "hexbin"</code> for plotting frequencies (not concentrations), which will produce a
plot by hexagonal binning.</p>
<p>If <code>statistic = "difference"</code> the trajectories associated with a
concentration greater than <code>percentile</code> are compared with the the full set of
trajectories to understand the differences in frequencies of the origin of
air masses of the highest concentration trajectories compared with the
trajectories on average. The comparison is made by comparing the percentage
change in gridded frequencies. For example, such a plot could show that the
top 10\<!-- % of concentrations of PM10 tend to originate from air-mass origins to -->
the east.</p>
<p>If <code>statistic = "pscf"</code> then the Potential Source Contribution Function is
plotted. The PSCF calculates the probability that a source is located at
latitude \(i\) and longitude \(j\) (Pekney et al., 2006).The basis of
PSCF is that if a source is located at (i,j), an air parcel back trajectory
passing through that location indicates that material from the source can be
collected and transported along the trajectory to the receptor site. PSCF
solves $$PSCF = m_{ij}/n_{ij}$$ where \(n_{ij}\) is the number of times
that the trajectories passed through the cell (i,j) and \(m_{ij}\) is the
number of times that a source concentration was high when the trajectories
passed through the cell (i,j). The criterion for determining \(m_{ij}\) is
controlled by <code>percentile</code>, which by default is 90. Note also that cells with
few data have a weighting factor applied to reduce their effect.</p>
<p>A limitation of the PSCF method is that grid cells can have the same PSCF
value when sample concentrations are either only slightly higher or much
higher than the criterion. As a result, it can be difficult to distinguish
moderate sources from strong ones. Seibert et al. (1994) computed
concentration fields to identify source areas of pollutants. The
Concentration Weighted Trajectory (CWT) approach considers the concentration
of a species together with its residence time in a grid cell. The CWT
approach has been shown to yield similar results to the PSCF approach. The
openair manual has more details and examples of these approaches.</p>
<p>A further useful refinement is to smooth the resulting surface, which is
possible by setting <code>smooth = TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>This function is under active development and is likely to change</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pekney, N. J., Davidson, C. I., Zhou, L., &amp; Hopke, P. K. (2006). Application
of PSCF and CPF to PMF-Modeled Sources of PM 2.5 in Pittsburgh. Aerosol
Science and Technology, 40(10), 952-961.</p>
<p>Seibert, P., Kromp-Kolb, H., Baltensperger, U., Jost, D., 1994. Trajectory
analysis of high-alpine air pollution data. NATO Challenges of Modern Society
18, 595-595.</p>
<p>Xie, Y., &amp; Berkowitz, C. M. (2007). The use of conditional probability
functions and potential source contribution functions to identify source
regions and advection pathways of hydrocarbon emissions in Houston, Texas.
Atmospheric Environment, 41(28), 5831-5847.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other trajectory analysis functions:
<code><a href="importTraj.html">importTraj()</a></code>,
<code><a href="trajCluster.html">trajCluster()</a></code>,
<code><a href="trajPlot.html">trajPlot()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David Carslaw</p>
<p>Jack Davison</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show a simple case with no pollutant i.e. just the trajectories</span></span></span>
<span class="r-in"><span><span class="co"># let's check to see where the trajectories were coming from when</span></span></span>
<span class="r-in"><span><span class="co"># Heathrow Airport was closed due to the Icelandic volcanic eruption</span></span></span>
<span class="r-in"><span><span class="co"># 15--21 April 2010.</span></span></span>
<span class="r-in"><span><span class="co"># import trajectories for London and plot</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">lond</span> <span class="op">&lt;-</span> <span class="fu"><a href="importTraj.html">importTraj</a></span><span class="op">(</span><span class="st">"london"</span>, <span class="fl">2010</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># more examples to follow linking with concentration measurements...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># import some measurements from KC1 - London</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">kc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="importUKAQ-wrapper.html">importAURN</a></span><span class="op">(</span><span class="st">"kc1"</span>, year <span class="op">=</span> <span class="fl">2010</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># now merge with trajectory data by 'date'</span></span></span>
<span class="r-in"><span><span class="va">lond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">lond</span>, <span class="va">kc1</span>, by <span class="op">=</span> <span class="st">"date"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># trajectory plot, no smoothing - and limit lat/lon area of interest</span></span></span>
<span class="r-in"><span><span class="co"># use PSCF</span></span></span>
<span class="r-in"><span><span class="fu">trajLevel</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lond</span>, <span class="va">lat</span> <span class="op">&gt;</span> <span class="fl">40</span> <span class="op">&amp;</span> <span class="va">lat</span> <span class="op">&lt;</span> <span class="fl">70</span> <span class="op">&amp;</span> <span class="va">lon</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">lon</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pollutant <span class="op">=</span> <span class="st">"pm10"</span>, statistic <span class="op">=</span> <span class="st">"pscf"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># can smooth surface, suing CWT approach:</span></span></span>
<span class="r-in"><span><span class="fu">trajLevel</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lond</span>, <span class="va">lat</span> <span class="op">&gt;</span> <span class="fl">40</span> <span class="op">&amp;</span> <span class="va">lat</span> <span class="op">&lt;</span> <span class="fl">70</span> <span class="op">&amp;</span> <span class="va">lon</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">lon</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pollutant <span class="op">=</span> <span class="st">"pm2.5"</span>, statistic <span class="op">=</span> <span class="st">"cwt"</span>, smooth <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot by season:</span></span></span>
<span class="r-in"><span><span class="fu">trajLevel</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">lond</span>, <span class="va">lat</span> <span class="op">&gt;</span> <span class="fl">40</span> <span class="op">&amp;</span> <span class="va">lat</span> <span class="op">&lt;</span> <span class="fl">70</span> <span class="op">&amp;</span> <span class="va">lon</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">lon</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pollutant <span class="op">=</span> <span class="st">"pm2.5"</span>,</span></span>
<span class="r-in"><span>  statistic <span class="op">=</span> <span class="st">"pscf"</span>, type <span class="op">=</span> <span class="st">"season"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Carslaw, Jack Davison, Karl Ropkins.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

